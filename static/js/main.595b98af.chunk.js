(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n(21)},17:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(4),s=n.n(r),i=(n(17),n(5)),c=n(6),l=n(10),u=n(7),d=n(11),m=(n(18),n(19),n(8)),v=n.n(m),h=n(1),N=n.n(h),f=n(9),b=n.n(f);function E(e){if(!e)throw new Error("invalid date, receive null");if("number"===typeof e)return new Date(e);if((t=e)&&"[object Date]"===w.call(t))return e;var t,n=new Date(e);return n.getTime()?n:B(e)}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD",n=(e=E(e)).getFullYear(),a=e.getMonth()+1,o=e.getDate(),r=e.getHours(),s=e.getMinutes(),i=e.getSeconds(),c={YY:(""+n).substr(-2),YYYY:""+n,M:""+a,MM:("0"+a).substr(-2),D:""+o,DD:("0"+o).substr(-2),H:""+r,HH:("0"+r).substr(-2),h:""+r%12,hh:("0"+r%12).substr(-2),m:""+s,mm:(""+s).substr(-2),s:""+i,ss:("0"+i).substr(-2)};return t.replace(/([a-zA-Z]+)/g,function(e,t){return c[t]||t})}var p=864e5,y=6e5;var g={parse:E,format:k,friendly:function(e){if(e=E(e),Date.now()-e.getTime()<y)return"\u521a\u521a";var t=new Date;t.setHours(23,59,59,999);var n=t.getTime()-e.getTime(),a=Math.floor(n/p),o=t.getFullYear()-e.getFullYear();return k(e,"".concat(["\u4eca\u5929","\u6628\u5929","\u524d\u5929"][a]||(0===o?"M\u6708D\u65e5":"YYYY\u5e74M\u6708D\u65e5")," H:m"))}},w=Object.prototype.toString;var D=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\.(\d{3})([-+]\d{4})$/,I=new Date("invalid");function B(e){var t=D.exec(e);if(!t)return I;var n=t.slice(1,8).map(function(e){return parseInt(e,10)}),a=new Date(Date.UTC(n[0],n[1]-1,n[2],n[3],n[4],n[5])),o=parseInt(t[8],10)/100*3600*1e3,r=a.getTime()-o;return new Date(r)}var x="development"===(Object({NODE_ENV:"production",PUBLIC_URL:"/fe-react-evernote"}).REACT_APP_ENV||"production")?"http://localhost:4000":"https://my-json-server.typicode.com/qingguatang/fe-react-evernote",S=function(e,t){var n=x+e;return window.fetch(n,t).then(function(e){return e.json()})},T=(n(20),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={notebooks:[],currentBookIndex:0,notes:[],currentNote:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("beforeunload",function(){var t={currentBookIndex:e.state.currentBookIndex,currentNoteId:e.state.currentNote?e.state.currentNote.id:null};localStorage.setItem("evernoteEditData",JSON.stringify(t))});var t=localStorage.getItem("evernoteEditData");if(t){var n=JSON.parse(t);this.setState({currentBookIndex:n.currentBookIndex})}this.loadNotebooks(n)}},{key:"render",value:function(){var e=this,t=this.state.notebooks,n=this.state.notes,a=this.state.currentNote;return o.a.createElement("div",{className:"app"},o.a.createElement("div",{className:"sidebar"},o.a.createElement("div",{className:"header"},o.a.createElement("button",{className:"button adder",onClick:function(){return e.addNote()}},o.a.createElement("i",{className:"iconfont icon-add"}),"\u65b0\u5efa\u7b14\u8bb0")),o.a.createElement("div",{className:"body"},o.a.createElement("div",{className:"notebooks"},o.a.createElement("div",{className:"header has-icon"},o.a.createElement("i",{className:"iconfont icon-books"}),"\u7b14\u8bb0\u672c"),o.a.createElement("div",{className:"body"},o.a.createElement("ul",{className:"notebooks-list"},t.map(function(t,n){return o.a.createElement("li",{key:t.id,className:N()("notebook-item",{active:e.state.currentBookIndex===n}),onClick:function(){return e.loadNotes(n)}},o.a.createElement("div",{className:"title has-icon"},o.a.createElement("i",{className:"iconfont icon-book"}),t.name),o.a.createElement("button",{className:"button trash"},o.a.createElement("i",{className:"iconfont icon-trash"})))})))))),o.a.createElement("div",{className:"notes-panel"},o.a.createElement("div",{className:"header"},"\u8bfb\u4e66\u7b14\u8bb0"),o.a.createElement("div",{className:"body"},o.a.createElement("ul",{className:"notes-list"},n.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement("div",{className:N()("note-brief",{active:a&&a.id===t.id})},o.a.createElement("div",{className:"box",onClick:function(){return e.loadNote(t.id)}},o.a.createElement("div",{className:"header"},t.title),o.a.createElement("div",{className:"body"},(n=(n=t.body)||"").length>100?n.substr(0,70)+"...":"")),o.a.createElement("div",{className:"footer"},o.a.createElement("div",{className:"datetime"},g.friendly(t.datetime)),o.a.createElement("button",{className:"trash button",onClick:function(){return e.deleteNote(t.id)}},o.a.createElement("i",{className:"iconfont icon-trash"})))));var n})))),a?o.a.createElement("div",{className:"note-panel"},o.a.createElement("div",{className:"header"},o.a.createElement("div",{className:"category has-icon"},o.a.createElement("i",{className:"iconfont icon-notebook"}),this.getNoteBook(a.notebookId).name),o.a.createElement("div",{className:"title"},o.a.createElement("input",{type:"text",value:a.title||"",onChange:function(t){return e.updateNote("title",t.target.value)}}))),o.a.createElement("div",{className:"body"},o.a.createElement("div",{className:"editor"},o.a.createElement("textarea",{value:a.body,onChange:function(t){return e.updateNote("body",t.target.value)}})),o.a.createElement("div",{className:"preview markdown-body"},o.a.createElement("div",{dangerouslySetInnerHTML:{__html:v()(a.body||"")}})))):null)}},{key:"loadNotebooks",value:function(e){var t=this;e=e||{},S("/notebooks").then(function(n){t.setState({notebooks:n},function(){var n=e.currentBookIndex||0;t.loadNotes(n),e.currentNoteId&&t.loadNote(e.currentNoteId)})})}},{key:"loadNotes",value:function(e){var t=this;this.setState({currentBookIndex:e});var n=this.state.notebooks[e];S("/notes?notebookId="+n.id).then(function(e){t.setState({notes:e})})}},{key:"reloadNotes",value:function(){var e=this.state.currentBookIndex;this.loadNotes(e)}},{key:"loadNote",value:function(e){var t=this;S("/notes/"+e).then(function(e){console.log(e),t.setState({currentNote:e})})}},{key:"getNoteBook",value:function(e){return this.state.notebooks.find(function(t){return t.id===e})}},{key:"updateNote",value:function(e,t){var n=this.state.currentNote;n[e]=t,this.setState({note:n});var a={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)};S("/notes/"+n.id,a).then(function(e){console.log("success!",e)})}},{key:"addNote",value:function(){var e=this,t=this.state.notebooks[this.state.currentBookIndex],n={title:"\u65b0\u5efa\u7b14\u8bb0",body:"",datetime:(new Date).toString(),notebookId:t.id},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)};S("/notes/",a).then(function(t){e.reloadNotes()})}},{key:"deleteNote",value:function(e){var t=this;b.a.fire({title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",type:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88"}).then(function(n){n.value&&t.doDeleteNote(e)})}},{key:"doDeleteNote",value:function(e){var t=this;S("/notes/"+e,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(function(e){t.reloadNotes()})}}]),t}(a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,1,2]]]);
//# sourceMappingURL=main.595b98af.chunk.js.map